---
title: Pytorch tutorial (2)
description: ê°€ì¤‘ì¹˜ í•™ìŠµìœ¼ë¡œ sin ê³¡ì„  ê·¼ì‚¬
date: 2024-10-24 12:13:00 -0400
categories: [Pytorch]
tags: [pytorch]     # TAG names should always be lowercase
---

# Pytorch tutorial (2)

ì„ì˜ì˜ ê°€ì¤‘ì¹˜ë¡œ ê·¸ë¦° ê³¡ì„ ê³¼ ì‹¤ì œ sin ê³¡ì„ ê³¼ ë¹„êµë¥¼ í†µí•´ ê°€ì¤‘ì¹˜ë¥¼ í•™ìŠµí•œ ê³¡ì„ ì„ ë¹„êµí•´ë³´ê² ìŠµë‹ˆë‹¤.

```python
# í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
import math
import toech
import matplotlib.pyplot as plt
```



```python
x = torch.linspace(-math.pi, math.pi, 1000) # -pië¶€í„° piì‚¬ì´ì˜ ì  1000ê°œ ì¶”ì¶œ
y = torch.sin(x) # sin ê³¡ì„ 
```

-ğ…ë¶€í„° ğ…ê¹Œì§€ xê°’ 1000ê°œë¥¼ ì¶”ì¶œí•˜ê³  ì •ë‹µë¹„êµë¥¼ ìœ„í•´ ```torch.sin()```í•¨ìˆ˜ë¡œ sin ê³¡ì„  yë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.

```python
# ì„ì˜ì˜ ê°€ì¤‘ì¹˜
a = torch.randn(())
b = torch.randn(())
c = torch.randn(())
d = torch.randn(())
```

randomí•œ ê°’ì„ ì„ì˜ì˜ ê°€ì¤‘ì¹˜ a,b,c,d ê°’ìœ¼ë¡œ ì •ì˜í•˜ê³ 

```python
y_rand = a * x**3 + b * x**2 + c * x + d

# ëœë¤ ê°€ì¤‘ì¹˜ì˜ ì‚¬ì¸ ê³¡ì„ 
plt.subplot(3, 1, 3)
plt.title("y random")
plt.plot(x, y_rand)
```

ëœë¤í•œ ê°€ì¤‘ì¹˜ ê°’ì„ ì ìš©í•œ 3ì°¨ ê³¡ì„  y_randëŠ” ì•„ë˜ì™€ ê°™ì´ ê·¸ë ¤ì§‘ë‹ˆë‹¤.

![y random ê³¡ì„ ](/images/Pytorch_2/pytorch_2_1.png)

ì´ë²ˆì—ëŠ” ì‹¤ì œ sin ê³¡ì„ ì¸ y ê°’ê³¼ ë¹„êµí•œ í›„ ê°€ì¤‘ì¹˜ë¥¼ í•™ìŠµí•´ì„œ ë§Œë“  í•¨ìˆ˜ y_pred ê°’ì„ ê·¸ë ¤ë³´ê² ìŠµë‹ˆë‹¤.

```python
# ê°€ì¤‘ì¹˜ í•™ìŠµ
learning_rate = 1e-6

for epoch in range(1000):
    y_pred = a * x**3 + b * x**2 + c * x + d
    
    loss = (y_pred - y).pow(2).sum().item() # ì†ì‹¤ MSE
    
    if epoch % 100 ==0:
        print(f"epoch : {epoch+1}, loss : {loss}")

    grad_y_pred = 2.0 * (y_pred - y)
    grad_a = (grad_y_pred * x ** 3).sum()
    grad_b = (grad_y_pred * x ** 2).sum()
    grad_c = (grad_y_pred * x).sum()
    grad_d = grad_y_pred.sum()

    # ê°€ì¤‘ì¹˜ ì—…ë°ì´íŠ¸
    a -= learning_rate * grad_a
    b -= learning_rate * grad_b
    c -= learning_rate * grad_c
    d -= learning_rate * grad_d
```

```
# output
epoch : 1, loss : 7937.68505859375
epoch : 101, loss : 3586.100830078125
epoch : 201, loss : 2924.1728515625
epoch : 301, loss : 2384.926025390625
epoch : 401, loss : 1945.4404296875
epoch : 501, loss : 1587.2352294921875
epoch : 601, loss : 1295.25390625
epoch : 701, loss : 1057.2337646484375
epoch : 801, loss : 863.1865234375
epoch : 901, loss : 704.974853515625z
```

y_predì— ëŒ€í•œ ê³¡ì„ ì„ ê·¸ë¦¬ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```python
# ì˜ˆì¸¡í•œ ê°€ì¤‘ì¹˜ì˜ ì‚¬ì¸ ê³¡ì„ 
plt.subplot(3, 1, 2)
plt.title("y pred")
plt.plot(x, y_pred)
```

![y predict ê³¡ì„ ](/images/Pytorch_2/pytorch_2_2.png)

ì•„ë˜ì˜ ì‹¤ì œ sin ê³¡ì„ ê³¼ ë¹„êµí•´ë³´ë©´ ê°€ì¤‘ì¹˜ í•™ìŠµì„ í†µí•´ì„œ y_pred ê°’ì´ sin í•¨ìˆ˜ì— ê·¼ì‚¬í•¨ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
# ì‹¤ì œ ì‚¬ì¸ê³¡ì„ 
plt.subplot(3, 1, 1)
plt.title("y true")
plt.plot(x, y)
```

![y true ê³¡ì„ ](/images/Pytorch_2/pytorch_2_2.png)


----
__reference__ - í…ì´ˆì˜ íŒŒì´í† ì¹˜ ë”¥ëŸ¬ë‹ íŠ¹ê°•